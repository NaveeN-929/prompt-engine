<!DOCTYPE html>
<html>
<head>
    <title>Direct UI Test</title>
    <style>
        body { font-family: Arial; margin: 20px; line-height: 1.6; }
        .test-section { background: #f0f8ff; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .result { background: #f9f9f9; padding: 15px; margin: 10px 0; border: 1px solid #ddd; white-space: pre-wrap; }
        button { background: #28a745; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        .error { background: #f8d7da; color: #721c24; }
        .success { background: #d4edda; color: #155724; }
    </style>
</head>
<body>
    <h1>üß™ Direct UI Test - Prompt Generation</h1>
    
    <div class="test-section">
        <h3>Test 1: Simple API Call</h3>
        <button onclick="testAPI()">Test API Directly</button>
        <div id="apiResult" class="result">Click button to test...</div>
    </div>
    
    <div class="test-section">
        <h3>Test 2: Full UI Simulation</h3>
        <button onclick="testUI()">Test UI Logic</button>
        <div id="uiResult" class="result">Click button to test...</div>
    </div>
    
    <div class="test-section">
        <h3>Test 3: Element Check</h3>
        <button onclick="checkElements()">Check DOM Elements</button>
        <div id="elementResult" class="result">Click button to test...</div>
    </div>

    <script>
        async function testAPI() {
            const result = document.getElementById('apiResult');
            try {
                result.textContent = 'Testing API...';
                
                const response = await fetch('http://localhost:5000/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        input_data: { transactions: [{ amount: 1500, type: 'credit' }] },
                        generation_type: 'standard'
                    })
                });
                
                const data = await response.json();
                
                if (response.ok && data.prompt) {
                    result.className = 'result success';
                    result.textContent = `‚úÖ API Working!
Status: ${response.status}
Prompt Length: ${data.prompt.length} chars
Vector Accelerated: ${data.vector_accelerated}
Processing Time: ${data.processing_time}s

First 500 chars of prompt:
${data.prompt.substring(0, 500)}...`;
                } else {
                    result.className = 'result error';
                    result.textContent = `‚ùå API Error: ${JSON.stringify(data, null, 2)}`;
                }
            } catch (error) {
                result.className = 'result error';
                result.textContent = `‚ùå Network Error: ${error.message}`;
            }
        }
        
        async function testUI() {
            const result = document.getElementById('uiResult');
            try {
                result.textContent = 'Testing UI logic...';
                
                // Simulate the exact UI logic
                const response = await fetch('http://localhost:5000/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        input_data: { transactions: [{ amount: 1500, type: 'credit' }] },
                        generation_type: 'standard'
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Simulate the exact UI display logic
                    const promptHTML = '<pre style="white-space: pre-wrap; word-wrap: break-word;">' + (data.prompt || 'No prompt generated') + '</pre>';
                    
                    result.className = 'result success';
                    result.innerHTML = `‚úÖ UI Logic Working!
                    
Simulated prompt display:
${promptHTML}

Metadata:
‚Ä¢ Vector Accelerated: ${data.vector_accelerated ? '‚ö° Yes' : '‚ùå No'}
‚Ä¢ Processing Time: ${(data.processing_time || 0).toFixed(3)}s
‚Ä¢ Prompt Length: ${data.prompt?.length || 0} chars`;
                } else {
                    result.className = 'result error';
                    result.textContent = `‚ùå UI Logic Error: ${data.error || 'Unknown error'}`;
                }
            } catch (error) {
                result.className = 'result error';
                result.textContent = `‚ùå UI Logic Exception: ${error.message}`;
            }
        }
        
        function checkElements() {
            const result = document.getElementById('elementResult');
            
            // Check if we can access the main UI (cross-origin)
            try {
                result.textContent = `Element Check Results:

1. This test page: ‚úÖ Working
2. Current URL: ${window.location.href}
3. Expected UI URL: http://localhost:5000/
4. Cross-origin access: Limited due to browser security

To properly test the UI:
1. Go directly to: http://localhost:5000/
2. Click "Generate Agentic Prompt" 
3. Check browser console (F12) for any JavaScript errors
4. Look for the "Complete Generated Prompt" section

If the prompt still doesn't show:
- Check browser console for errors
- Try refreshing the page
- Try a different browser`;
                
                result.className = 'result';
            } catch (error) {
                result.className = 'result error';
                result.textContent = `‚ùå Element check error: ${error.message}`;
            }
        }
    </script>
</body>
</html>